import{f as I,a as p,c as J,t as K}from"../chunks/DCvXmXlu.js";import{i as $e}from"../chunks/6IICz2GY.js";import{o as Ce,a as Ee}from"../chunks/CisEU1wO.js";import{h as le,f as Pe,aF as H,aG as Ve,P,i as De,g as N,o as f,n as S,l as e,j as w,k as y,t as q,w as L,aH as ce}from"../chunks/CR1LdmZO.js";import{s as V,e as ue}from"../chunks/CJtA_M2M.js";import{i as A,s as qe,a as fe}from"../chunks/KBBR2veS.js";import{s as Ge,g as Q}from"../chunks/JQOoPsjm.js";import{w as Fe}from"../chunks/Bp1PtkwD.js";const ve=[...` 	
\r\fÂ \v\uFEFF`];function He(s,_,m){var n=""+s;if(m){for(var a in m)if(m[a])n=n?n+" "+a:a;else if(n.length)for(var c=a.length,t=0;(t=n.indexOf(a,t))>=0;){var i=t+c;(t===0||ve.includes(n[t-1]))&&(i===n.length||ve.includes(n[i]))?n=(t===0?"":n.substring(0,t))+n.substring(i+1):t=i}}return n===""?null:n}function Oe(s,_,m,n,a,c){var t=s.__className;if(le||t!==m||t===void 0){var i=He(m,n,c);(!le||i!==s.getAttribute("class"))&&(i==null?s.removeAttribute("class"):s.className=i),s.__className=m}else if(c&&a!==c)for(var b in c){var j=!!c[b];(a==null||j!==!!a[b])&&s.classList.toggle(b,j)}return c}const Ue=()=>{const s=Ge;return{page:{subscribe:s.page.subscribe},navigating:{subscribe:s.navigating.subscribe},updated:s.updated}},Be={subscribe(s){return Ue().page.subscribe(s)}};function X(s){return typeof s=="number"?s:typeof s=="string"?parseInt(s,10):0}function Me(s){const _=[],m=n=>{const a=n.sets||1,c=X(n.rest);for(let t=0;t<a;t++)_.push({name:n.name,type:n.type,amount:n.type==="time"?X(n.amount):n.amount,notes:n.notes}),c>0&&t<a-1&&_.push({name:"Rest",type:"time",amount:c,notes:`Rest after set ${t+1} of ${n.name}`})};if(s.exercises)for(const n of s.exercises)m(n);else if(s.rounds)for(let n=0;n<s.rounds.length;n++){const a=s.rounds[n],c=X(a.rest_after_round);for(let t=0;t<a.count;t++){for(const j of a.exercises)m(j);const i=t===a.count-1,b=n===s.rounds.length-1;c>0&&(!i||!b)&&_.push({name:"Round Rest",type:"time",amount:c,notes:`Rest after round ${t+1}`})}}return _}var Ye=I('<p class="svelte-thejo2">Loading workout...</p>'),ze=I('<h1 class="workout-complete svelte-thejo2">Workout Complete! ðŸŽ‰</h1> <button class="main-control svelte-thejo2">Go Home</button>',1),Je=I('<p class="svelte-thejo2"> </p>'),Ke=I('<div class="timer-display svelte-thejo2"> </div>'),Qe=I('<div class="reps-display svelte-thejo2"> </div>'),Xe=I('<h2 class="svelte-thejo2"> </h2> <h1 class="svelte-thejo2"> </h1> <!> <!> <button><!></button>',1),Ze=I('<div class="next-up-banner svelte-thejo2">Next up: <strong> </strong></div>'),et=I('<div class="container svelte-thejo2"><!></div> <!>',1);function ct(s,_){Pe(_,!1);const m=()=>fe(Be,"$page",a),n=()=>fe(Fe,"$workouts",a),[a,c]=qe(),t=S(),i=S(),b=S(),j=S();let v=S([]),k=S(0),g=S(0),G,x=S(!0),R=null,h=null;function pe(){if(!h)return;const o=h.currentTime,r=h.createGain();r.connect(h.destination),r.gain.setValueAtTime(.5,o),r.gain.exponentialRampToValueAtTime(.001,o+1);const d=h.createOscillator();d.connect(r),d.type="sawtooth",d.frequency.setValueAtTime(523.25,o),d.start(o),d.stop(o+1)}function de(){const o=e(i)?`Next up: ${e(i).name}`:"You did it!",r=new SpeechSynthesisUtterance(o);speechSynthesis.speak(r)}async function Z(){if("wakeLock"in navigator)try{R=await navigator.wakeLock.request("screen"),console.log("Screen Wake Lock activated."),R.addEventListener("release",()=>{console.log("Screen Wake Lock released automatically.")})}catch(o){console.error(`Failed to activate wake lock: ${o.name}, ${o.message}`)}else console.warn("Screen Wake Lock API not supported.")}function T(){R&&(R.release(),R=null,console.log("Screen Wake Lock released manually."))}function ee(){R!==null&&document.visibilityState==="visible"&&!e(x)&&Z()}Ce(()=>{const o=m().params.slug;if(!o){Q("/");return}const r=decodeURIComponent(o),d=n().find($=>$.name===r);d?(f(v,Me(d)),e(v).length>0&&e(v)[0].type==="time"&&f(g,e(v)[0].amount)):Q("/");try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}document.addEventListener("visibilitychange",ee),window.addEventListener("pagehide",T)});function te(){f(x,!1),Z(),e(g)<=0&&e(t).type==="time"&&f(g,e(t).amount),G=setInterval(()=>{ce(g,-1),e(t).type==="time"&&e(g)===5&&de(),e(g)<=0&&(pe(),ne())},1e3)}function ne(){clearInterval(G);const o=e(k)+1;if(o<e(v).length){f(k,o);const r=e(v)[o];r.type==="time"?(f(g,r.amount),te()):(f(x,!0),f(g,0),T())}else ce(k),f(x,!0),f(g,0),T()}function me(){if(e(t)){if(e(t).type==="reps"){ne();return}if(e(x)){if(!h)try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}te()}else f(x,!0),clearInterval(G),T()}}Ee(()=>{clearInterval(G),T(),document.removeEventListener("visibilitychange",ee),window.removeEventListener("pagehide",T),h&&h.close()}),H(()=>(e(v),e(k)),()=>{f(t,e(v)[e(k)])}),H(()=>(e(v),e(k)),()=>{f(i,e(v)[e(k)+1])}),H(()=>(e(t),e(v)),()=>{f(b,e(t)===void 0&&e(v).length>0)}),H(()=>(e(g),e(t)),()=>{f(j,e(g)>0?e(g):e(t)?.type==="time"?e(t).amount:0)}),Ve(),$e();var oe=et(),O=P(oe),ge=w(O);{var he=o=>{var r=Ye();p(o,r)},_e=o=>{var r=J(),d=P(r);{var $=C=>{var D=ze(),U=N(P(D),2);ue("click",U,()=>Q("/")),p(C,D)},ye=C=>{var D=J(),U=P(D);{var ke=B=>{var se=Xe(),M=P(se),xe=w(M);y(M);var Y=N(M,2),Se=w(Y,!0);y(Y);var ae=N(Y,2);{var Le=l=>{var u=Je(),W=w(u,!0);y(u),q(()=>V(W,(e(t),L(()=>e(t).notes)))),p(l,u)};A(ae,l=>{e(t),L(()=>e(t).notes)&&l(Le)})}var re=N(ae,2);{var Ae=l=>{var u=Ke(),W=w(u);y(u),q(()=>V(W,`${e(j)??""}s`)),p(l,u)},Ie=l=>{var u=Qe(),W=w(u);y(u),q(()=>V(W,`${e(t),L(()=>e(t).amount)??""} reps`)),p(l,u)};A(re,l=>{e(t),L(()=>e(t).type==="time")?l(Ae):l(Ie,!1)})}var F=N(re,2);let ie;var je=w(F);{var We=l=>{var u=K("Next");p(l,u)},Ne=l=>{var u=J(),W=P(u);{var Re=E=>{var z=K("Start");p(E,z)},Te=E=>{var z=K("Pause");p(E,z)};A(W,E=>{e(x)?E(Re):E(Te,!1)},!0)}p(l,u)};A(je,l=>{e(t),L(()=>e(t).type==="reps")?l(We):l(Ne,!1)})}y(F),q(()=>{V(xe,`Step ${e(k)+1} of ${e(v),L(()=>e(v).length)??""}`),V(Se,(e(t),L(()=>e(t).name))),ie=Oe(F,1,"main-control svelte-thejo2",null,ie,{pause:e(t).type==="time"&&!e(x)})}),ue("click",F,me),p(B,se)};A(U,B=>{e(t)&&B(ke)},!0)}p(C,D)};A(d,C=>{e(b)?C($):C(ye,!1)},!0)}p(o,r)};A(ge,o=>{!e(t)&&!e(b)?o(he):o(_e,!1)})}y(O);var be=N(O,2);{var we=o=>{var r=Ze(),d=N(w(r)),$=w(d,!0);y(d),y(r),q(()=>V($,(e(i),L(()=>e(i).name)))),p(o,r)};A(be,o=>{e(i)&&o(we)})}p(s,oe),De(),c()}export{ct as component};

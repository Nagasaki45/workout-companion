import{f as S,a as g,c as aa}from"../chunks/aMNKUq1k.js";import{i as ea}from"../chunks/CpFSCype.js";import{l as sa,c as St,aj as ra,p as oa,S as la,ak as va,al as ia,v as na,B as ua,K as pa,L as ca,C as da,z as t,y as Et,am as st,A as F,F as u,I as l,M as rt,D as e,u as d,J,an as ot,ao as A,ai as fa,af as Ut}from"../chunks/C-nfCbfq.js";import{e as C,s as G}from"../chunks/064OOvbh.js";import{i as H}from"../chunks/CEdrGF4v.js";import{r as j,s as _,e as Rt,i as _a}from"../chunks/BWomK3WN.js";import{b as O}from"../chunks/COnlji1G.js";import{s as ma,a as Ft}from"../chunks/CKJrsXZy.js";import{p as ba}from"../chunks/BKb5AL-F.js";import{w as jt}from"../chunks/C_6LLp3Z.js";import{g as lt}from"../chunks/CSbwRu96.js";function Bt(v,w,M=!1){if(v.multiple){if(w==null)return;if(!la(w))return va();for(var k of v.options)k.selected=w.includes(Z(k));return}for(k of v.options){var W=Z(k);if(ia(W,w)){k.selected=!0;return}}(!M||w!==void 0)&&(v.selectedIndex=-1)}function wa(v){var w=new MutationObserver(()=>{Bt(v,v.__value)});w.observe(v,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),na(()=>{w.disconnect()})}function za(v,w,M=w){var k=new WeakSet,W=!0;sa(v,"change",R=>{var a=R?"[selected]":":checked",m;if(v.multiple)m=[].map.call(v.querySelectorAll(a),Z);else{var q=v.querySelector(a)??v.querySelector("option:not([disabled])");m=q&&Z(q)}M(m),St!==null&&k.add(St)}),ra(()=>{var R=w();if(v===document.activeElement){var a=oa??St;if(k.has(a))return}if(Bt(v,R,W),W&&R===void 0){var m=v.querySelector(":checked");m!==null&&(R=Z(m),M(R))}v.__value=R,W=!1}),wa(v)}function Z(v){return"__value"in v?v.__value:v.value}var $a=S('<div class="exercise-item svelte-15w24zp"><div class="move-buttons svelte-15w24zp"><button class="move-button svelte-15w24zp">&uarr;</button> <button class="move-button svelte-15w24zp">&darr;</button></div> <div class="exercise-form svelte-15w24zp"><div><label class="svelte-15w24zp">Name</label> <input class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Type</label> <select class="svelte-15w24zp"><option>Reps</option><option>Time</option></select></div> <div><label class="svelte-15w24zp">Amount</label> <input type="text" class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Sets</label> <input type="number" min="1" class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Rest</label> <input type="text" placeholder="e.g. 45" class="svelte-15w24zp"/></div> <div class="exercise-form-notes svelte-15w24zp"><label class="svelte-15w24zp">Notes</label> <textarea rows="2" class="svelte-15w24zp"></textarea></div></div> <button class="button-delete-small svelte-15w24zp" title="Delete Exercise">&times;</button></div>'),ha=S('<div class="round-card svelte-15w24zp"><div class="round-header svelte-15w24zp"><div class="move-buttons svelte-15w24zp"><button class="move-button svelte-15w24zp">&uarr;</button> <button class="move-button svelte-15w24zp">&darr;</button></div> <h3 class="svelte-15w24zp"> </h3> <div class="round-controls svelte-15w24zp"><label class="svelte-15w24zp">Count:</label> <input type="number" min="1" class="svelte-15w24zp"/> <label class="svelte-15w24zp">Rest After:</label> <input type="text" placeholder="e.g. 60" class="svelte-15w24zp"/></div> <button class="button-delete-small svelte-15w24zp" title="Delete Round">&times;</button></div> <div class="exercise-list svelte-15w24zp"></div> <button class="button-add svelte-15w24zp">+ Add Exercise</button></div>'),ga=S('<div class="rounds-container"></div> <button class="button-add svelte-15w24zp">+ Add Round</button>',1),ka=S("<span> </span>"),ya=S("<span> </span>"),Sa=S('<div class="exercise-notes svelte-15w24zp"> </div>'),Ea=S('<li class="svelte-15w24zp"><div class="exercise-name svelte-15w24zp"> </div> <div class="exercise-details svelte-15w24zp"> <!> <!></div> <!></li>'),Ra=S('<p>Inline editing for this workout format is not yet available.</p> <ul class="exercise-list standalone svelte-15w24zp"></ul>',1),Na=S('<input class="workout-name-input svelte-15w24zp"/> <div class="actions svelte-15w24zp"><button class="button button-save svelte-15w24zp">Save</button> <a class="button button-cancel svelte-15w24zp">Cancel</a></div> <h2 class="svelte-15w24zp">Workout Structure</h2> <!>',1),Aa=S("<p>Workout not found. Loading...</p>"),Ca=S('<div class="container svelte-15w24zp"><!></div>');function Ba(v,w){ua(w,!1);const M=()=>Ft(ba,"$page",W),k=()=>Ft(jt,"$workouts",W),[W,R]=ma();let a=Et(),m=Et(""),q=Et(0);function Kt(){if(!t(a))return;const s=JSON.parse(JSON.stringify(t(a)));s.rounds&&s.rounds.forEach(i=>{delete i.id,i.exercises.forEach(n=>delete n.id)}),s.rounds&&s.rounds.forEach(i=>{i.count=Number(i.count)||1,i.exercises.forEach(n=>{n.amount=Number(n.amount)||0,n.sets=Number(n.sets)||1})}),jt.update(i=>{const n=new Map(i.map(p=>[p.name,p]));return t(m)&&t(m)!==s.name&&n.delete(t(m)),n.set(s.name,s),Array.from(n.values())}),lt(`/workout/${encodeURIComponent(s.name)}`)}function Gt(){t(a)&&(t(a).rounds||ot(a,t(a).rounds=[]),t(a).rounds.push({id:st(q),count:1,exercises:[{}]}),F(a,t(a)))}function Ht(s){!t(a)||!t(a).rounds||confirm("Are you sure you want to delete this round?")&&(t(a).rounds.splice(s,1),F(a,t(a)))}function Pt(s){!t(a)||!t(a).rounds||(t(a).rounds[s].exercises.push({id:st(q)}),F(a,t(a)))}function Qt(s,i){!t(a)||!t(a).rounds||confirm("Are you sure you want to delete this exercise?")&&(t(a).rounds[s].exercises.splice(i,1),F(a,t(a)))}function Nt(s,i){if(!t(a)||!t(a).rounds)return;const n=i==="up"?s-1:s+1;if(n<0||n>=t(a).rounds.length)return;const[p]=t(a).rounds.splice(s,1);t(a).rounds.splice(n,0,p),ot(a,t(a).rounds=t(a).rounds)}function At(s,i,n){if(!t(a)||!t(a).rounds)return;const p=t(a).rounds[s].exercises,N=n==="up"?i-1:i+1;if(N<0||N>=p.length)return;const[P]=p.splice(i,1);p.splice(N,0,P),ot(a,t(a).rounds[s].exercises=p),F(a,t(a))}pa(()=>(M(),t(a),t(m),k(),t(q),lt),()=>{const s=M().params.slug;if(s){const i=decodeURIComponent(s);if(!t(a)||t(m)!==i){const n=k().find(p=>p.name===i);if(n){const p=JSON.parse(JSON.stringify(n));p.rounds&&p.rounds.forEach(N=>{N.id=st(q),N.exercises.forEach(P=>{P.id=st(q)})}),F(a,p),F(m,t(a).name)}else lt("/")}}else lt("/")}),ca(),ea();var vt=Ca(),Vt=u(vt);{var Xt=s=>{var i=Na(),n=rt(i);j(n);var p=e(n,2),N=u(p),P=e(N,2);l(p);var Zt=e(p,4);{var It=E=>{var Q=ga(),V=rt(Q);Rt(V,7,()=>(t(a),d(()=>t(a).rounds)),D=>D.id,(D,f,r)=>{var X=ha(),o=u(X),L=u(o),T=u(L),I=e(T,2);l(L);var U=e(L,2),x=u(U);l(U);var B=e(U,2),tt=u(B),K=e(tt,2);j(K);var at=e(K,2),Y=e(at,2);j(Y),l(B);var nt=e(B,2);l(o);var b=e(o,2);Rt(b,7,()=>(t(f),d(()=>t(f).exercises)),$=>$.id,($,h,c)=>{var ut=$a(),pt=u(ut),ct=u(pt),Ct=e(ct,2);l(pt);var dt=e(pt,2),ft=u(dt),Wt=u(ft),_t=e(Wt,2);j(_t),l(ft);var mt=e(ft,2),qt=u(mt),et=e(qt,2);J(()=>{t(h),A(()=>{t(r),t(c)})});var bt=u(et);bt.value=bt.__value="reps";var Jt=e(bt);Jt.value=Jt.__value="time",l(et),l(mt);var wt=e(mt,2),Ot=u(wt),zt=e(Ot,2);j(zt),l(wt);var $t=e(wt,2),Mt=u($t),ht=e(Mt,2);j(ht),l($t);var gt=e($t,2),Dt=u(gt),kt=e(Dt,2);j(kt),l(gt);var Lt=e(gt,2),Tt=u(Lt),yt=e(Tt,2);fa(yt),l(Lt),l(dt);var ta=e(dt,2);l(ut),J(()=>{ct.disabled=t(c)===0,Ct.disabled=(Ut(t(c)),t(f),d(()=>t(c)===t(f).exercises.length-1)),_(Wt,"for",`ex-name-${t(r)??""}-${t(c)??""}`),_(_t,"id",`ex-name-${t(r)??""}-${t(c)??""}`),_(qt,"for",`ex-type-${t(r)??""}-${t(c)??""}`),_(et,"id",`ex-type-${t(r)??""}-${t(c)??""}`),_(Ot,"for",`ex-amount-${t(r)??""}-${t(c)??""}`),_(zt,"id",`ex-amount-${t(r)??""}-${t(c)??""}`),_(Mt,"for",`ex-sets-${t(r)??""}-${t(c)??""}`),_(ht,"id",`ex-sets-${t(r)??""}-${t(c)??""}`),_(Dt,"for",`ex-rest-${t(r)??""}-${t(c)??""}`),_(kt,"id",`ex-rest-${t(r)??""}-${t(c)??""}`),_(Tt,"for",`ex-notes-${t(r)??""}-${t(c)??""}`),_(yt,"id",`ex-notes-${t(r)??""}-${t(c)??""}`)}),C("click",ct,()=>At(t(r),t(c),"up")),C("click",Ct,()=>At(t(r),t(c),"down")),O(_t,()=>t(h).name,y=>(t(h).name=y,A(()=>(t(f),t(a))))),za(et,()=>t(h).type,y=>(t(h).type=y,A(()=>(t(f),t(a))))),O(zt,()=>t(h).amount,y=>(t(h).amount=y,A(()=>(t(f),t(a))))),O(ht,()=>t(h).sets,y=>(t(h).sets=y,A(()=>(t(f),t(a))))),O(kt,()=>t(h).rest,y=>(t(h).rest=y,A(()=>(t(f),t(a))))),O(yt,()=>t(h).notes,y=>(t(h).notes=y,A(()=>(t(f),t(a))))),C("click",ta,()=>Qt(t(r),t(c))),g($,ut)}),l(b);var z=e(b,2);l(X),J(()=>{T.disabled=t(r)===0,I.disabled=(Ut(t(r)),t(a),d(()=>t(r)===t(a).rounds.length-1)),G(x,`Round ${t(r)+1}`),_(tt,"for",`round-count-${t(r)??""}`),_(K,"id",`round-count-${t(r)??""}`),_(at,"for",`round-rest-${t(r)??""}`),_(Y,"id",`round-rest-${t(r)??""}`)}),C("click",T,()=>Nt(t(r),"up")),C("click",I,()=>Nt(t(r),"down")),O(K,()=>t(f).count,$=>(t(f).count=$,A(()=>t(a)))),O(Y,()=>t(f).rest_after_round,$=>(t(f).rest_after_round=$,A(()=>t(a)))),C("click",nt,()=>Ht(t(r))),C("click",z,()=>Pt(t(r))),g(D,X)}),l(V);var it=e(V,2);C("click",it,Gt),g(E,Q)},xt=E=>{var Q=aa(),V=rt(Q);{var it=D=>{var f=Ra(),r=e(rt(f),2);Rt(r,5,()=>(t(a),d(()=>t(a).exercises)),_a,(X,o)=>{var L=Ea(),T=u(L),I=u(T,!0);l(T);var U=e(T,2),x=u(U),B=e(x);{var tt=b=>{var z=ka(),$=u(z);l(z),J(()=>G($,` • ${t(o),d(()=>t(o).sets)??""} sets`)),g(b,z)};H(B,b=>{t(o),d(()=>t(o).sets&&t(o).sets>1)&&b(tt)})}var K=e(B,2);{var at=b=>{var z=ya(),$=u(z);l(z),J(()=>G($,` • ${t(o),d(()=>t(o).rest)??""}${t(o),d(()=>typeof t(o).rest=="number"?"s":"")??""}
                  rest`)),g(b,z)};H(K,b=>{t(o),d(()=>t(o).rest)&&b(at)})}l(U);var Y=e(U,2);{var nt=b=>{var z=Sa(),$=u(z,!0);l(z),J(()=>G($,(t(o),d(()=>t(o).notes)))),g(b,z)};H(Y,b=>{t(o),d(()=>t(o).notes)&&b(nt)})}l(L),J(()=>{G(I,(t(o),d(()=>t(o).name))),G(x,`${t(o),d(()=>t(o).amount)??""}${t(o),d(()=>t(o).type==="reps"?" reps":typeof t(o).amount=="number"?"s":"")??""} `)}),g(X,L)}),l(r),g(D,f)};H(V,D=>{t(a),d(()=>t(a).exercises)&&D(it)},!0)}g(E,Q)};H(Zt,E=>{t(a),d(()=>t(a).rounds)?E(It):E(xt,!1)})}J(E=>_(P,"href",`/workout/${E??""}`),[()=>(t(m),d(()=>encodeURIComponent(t(m))))]),O(n,()=>t(a).name,E=>ot(a,t(a).name=E)),C("click",N,Kt),g(s,i)},Yt=s=>{var i=Aa();g(s,i)};H(Vt,s=>{t(a)?s(Xt):s(Yt,!1)})}l(vt),g(v,vt),da(),R()}export{Ba as component};

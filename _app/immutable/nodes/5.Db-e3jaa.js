import{f as I,a as v,c as j,t as K}from"../chunks/BaYVzIlS.js";import{i as $e}from"../chunks/C9QFpJqr.js";import{o as Ee,a as Pe}from"../chunks/DHPxrwZa.js";import{h as le,B as Ve,ak as O,al as De,af as V,C as qe,z as e,y as S,D as R,A as f,F as y,I as w,J as B,u as L,am as ce}from"../chunks/DGYGATz2.js";import{s as D,e as ue}from"../chunks/B5P6LH3H.js";import{i as A}from"../chunks/ChU5yNDt.js";import{s as Be,a as fe}from"../chunks/CDk6z-82.js";import{p as Fe}from"../chunks/BfR5zUh3.js";import{w as Ge}from"../chunks/DOHu0OQc.js";import{g as Q}from"../chunks/oDULkbCW.js";const pe=[...` 	
\r\fÂ \v\uFEFF`];function Oe(o,k,d){var a=""+o;if(d){for(var s in d)if(d[s])a=a?a+" "+s:s;else if(a.length)for(var c=s.length,t=0;(t=a.indexOf(s,t))>=0;){var i=t+c;(t===0||pe.includes(a[t-1]))&&(i===a.length||pe.includes(a[i]))?a=(t===0?"":a.substring(0,t))+a.substring(i+1):t=i}}return a===""?null:a}function Ue(o,k,d,a,s,c){var t=o.__className;if(le||t!==d||t===void 0){var i=Oe(d,a,c);(!le||i!==o.getAttribute("class"))&&(i==null?o.removeAttribute("class"):o.className=i),o.__className=d}else if(c&&s!==c)for(var _ in c){var W=!!c[_];(s==null||W!==!!s[_])&&o.classList.toggle(_,W)}return c}function X(o){return typeof o=="number"?o:typeof o=="string"?parseInt(o,10):0}function ze(o){const k=[],d=a=>{const s=a.sets||1,c=X(a.rest);for(let t=0;t<s;t++)k.push({name:a.name,type:a.type,amount:a.type==="time"?X(a.amount):a.amount,notes:a.notes}),c>0&&t<s-1&&k.push({name:"Rest",type:"time",amount:c,notes:`Rest after set ${t+1} of ${a.name}`})};if(o.exercises)for(const a of o.exercises)d(a);else if(o.rounds)for(let a=0;a<o.rounds.length;a++){const s=o.rounds[a],c=X(s.rest_after_round);for(let t=0;t<s.count;t++){for(const W of s.exercises)d(W);const i=t===s.count-1,_=a===o.rounds.length-1;c>0&&(!i||!_)&&k.push({name:"Round Rest",type:"time",amount:c,notes:`Rest after round ${t+1}`})}}return k}var He=I('<p class="svelte-1l4ap58">Loading workout...</p>'),Je=I('<h1 class="workout-complete svelte-1l4ap58">Workout Complete! ðŸŽ‰</h1> <button class="main-control svelte-1l4ap58">Go Home</button>',1),Me=I('<p class="svelte-1l4ap58"> </p>'),Ye=I('<div class="timer-display svelte-1l4ap58"> </div>'),je=I('<div class="reps-display svelte-1l4ap58"> </div>'),Ke=I('<h2 class="svelte-1l4ap58"> </h2> <h1 class="svelte-1l4ap58"> </h1> <!> <!> <button><!></button>',1),Qe=I('<div class="next-up-banner svelte-1l4ap58"><span class="svelte-1l4ap58">Next up</span> <strong class="svelte-1l4ap58"> </strong></div>'),Xe=I('<div class="container svelte-1l4ap58"><!></div> <!>',1);function ct(o,k){Ve(k,!1);const d=()=>fe(Fe,"$page",s),a=()=>fe(Ge,"$workouts",s),[s,c]=Be(),t=S(),i=S(),_=S(),W=S();let p=S([]),b=S(0),g=S(0),F,x=S(!0),T=null,h=null;function ve(){if(!h)return;const n=h.currentTime,r=h.createGain();r.connect(h.destination),r.gain.setValueAtTime(.5,n),r.gain.exponentialRampToValueAtTime(.001,n+1);const m=h.createOscillator();m.connect(r),m.type="sawtooth",m.frequency.setValueAtTime(523.25,n),m.start(n),m.stop(n+1)}function me(){const n=e(i)?`Next up: ${e(i).name}`:"You did it!",r=new SpeechSynthesisUtterance(n);speechSynthesis.speak(r)}async function Z(){if("wakeLock"in navigator)try{T=await navigator.wakeLock.request("screen"),console.log("Screen Wake Lock activated."),T.addEventListener("release",()=>{console.log("Screen Wake Lock released automatically.")})}catch(n){console.error(`Failed to activate wake lock: ${n.name}, ${n.message}`)}else console.warn("Screen Wake Lock API not supported.")}function C(){T&&(T.release(),T=null,console.log("Screen Wake Lock released manually."))}function ee(){T!==null&&document.visibilityState==="visible"&&!e(x)&&Z()}Ee(()=>{const n=d().params.slug;if(!n){Q("/");return}const r=decodeURIComponent(n),m=a().find($=>$.name===r);m?(f(p,ze(m)),e(p).length>0&&e(p)[0].type==="time"&&f(g,e(p)[0].amount)):Q("/");try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}document.addEventListener("visibilitychange",ee),window.addEventListener("pagehide",C)});function te(){f(x,!1),Z(),e(g)<=0&&e(t).type==="time"&&f(g,e(t).amount),F=setInterval(()=>{ce(g,-1),e(t).type==="time"&&e(g)===5&&me(),e(g)<=0&&(ve(),ae())},1e3)}function ae(){clearInterval(F);const n=e(b)+1;if(n<e(p).length){f(b,n);const r=e(p)[n];r.type==="time"?(f(g,r.amount),te()):(f(x,!0),f(g,0),C())}else ce(b),f(x,!0),f(g,0),C()}function de(){if(e(t)){if(e(t).type==="reps"){ae();return}if(e(x)){if(!h)try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}te()}else f(x,!0),clearInterval(F),C()}}Pe(()=>{clearInterval(F),C(),document.removeEventListener("visibilitychange",ee),window.removeEventListener("pagehide",C),h&&h.close()}),O(()=>(e(p),e(b)),()=>{f(t,e(p)[e(b)])}),O(()=>(e(p),e(b)),()=>{f(i,e(p)[e(b)+1])}),O(()=>(e(t),e(p)),()=>{f(_,e(t)===void 0&&e(p).length>0)}),O(()=>(e(g),e(t)),()=>{f(W,e(g)>0?e(g):e(t)?.type==="time"?e(t).amount:0)}),De(),$e();var ne=Xe(),U=V(ne),ge=y(U);{var he=n=>{var r=He();v(n,r)},_e=n=>{var r=j(),m=V(r);{var $=E=>{var q=Je(),z=R(V(q),2);ue("click",z,()=>Q("/")),v(E,q)},ke=E=>{var q=j(),z=V(q);{var be=H=>{var oe=Ke(),J=V(oe),xe=y(J);w(J);var M=R(J,2),Se=y(M,!0);w(M);var se=R(M,2);{var Le=l=>{var u=Me(),N=y(u,!0);w(u),B(()=>D(N,(e(t),L(()=>e(t).notes)))),v(l,u)};A(se,l=>{e(t),L(()=>e(t).notes)&&l(Le)})}var re=R(se,2);{var Ae=l=>{var u=Ye(),N=y(u);w(u),B(()=>D(N,`${e(W)??""}s`)),v(l,u)},Ie=l=>{var u=je(),N=y(u);w(u),B(()=>D(N,`${e(t),L(()=>e(t).amount)??""} reps`)),v(l,u)};A(re,l=>{e(t),L(()=>e(t).type==="time")?l(Ae):l(Ie,!1)})}var G=R(re,2);let ie;var We=y(G);{var Ne=l=>{var u=K("Next");v(l,u)},Re=l=>{var u=j(),N=V(u);{var Te=P=>{var Y=K("Start");v(P,Y)},Ce=P=>{var Y=K("Pause");v(P,Y)};A(N,P=>{e(x)?P(Te):P(Ce,!1)},!0)}v(l,u)};A(We,l=>{e(t),L(()=>e(t).type==="reps")?l(Ne):l(Re,!1)})}w(G),B(()=>{D(xe,`Step ${e(b)+1} of ${e(p),L(()=>e(p).length)??""}`),D(Se,(e(t),L(()=>e(t).name))),ie=Ue(G,1,"main-control svelte-1l4ap58",null,ie,{pause:e(t).type==="time"&&!e(x)})}),ue("click",G,de),v(H,oe)};A(z,H=>{e(t)&&H(be)},!0)}v(E,q)};A(m,E=>{e(_)?E($):E(ke,!1)},!0)}v(n,r)};A(ge,n=>{!e(t)&&!e(_)?n(he):n(_e,!1)})}w(U);var ye=R(U,2);{var we=n=>{var r=Qe(),m=R(y(r),2),$=y(m,!0);w(m),w(r),B(()=>D($,(e(i),L(()=>e(i).name)))),v(n,r)};A(ye,n=>{e(i)&&n(we)})}v(o,ne),qe(),c()}export{ct as component};

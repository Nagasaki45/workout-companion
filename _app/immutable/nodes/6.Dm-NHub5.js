import{f as I,a as v,c as z,e as le,t as J}from"../chunks/BDuLsZKY.js";import{i as Ce}from"../chunks/CU28HvW-.js";import{o as Ee,a as Pe}from"../chunks/Bb_77kpF.js";import{h as ce,a0 as Ve,a7 as B,a8 as qe,a9 as V,a1 as De,e,x as S,a3 as R,Z as f,a2 as y,a5 as w,a6 as G,u as L,aq as ue}from"../chunks/CEpFFJjy.js";import{s as q}from"../chunks/CoB_gn-2.js";import{i as A}from"../chunks/YPQZep5m.js";import{s as Ge,a as fe}from"../chunks/DyuGTZZS.js";import{p as Oe}from"../chunks/C-5BzL7G.js";import{w as Ue}from"../chunks/CKlytb3N.js";import{g as K}from"../chunks/D_F1M1T5.js";const pe=[...` 	
\r\fÂ \v\uFEFF`];function Be(o,k,d){var a=""+o;if(d){for(var s in d)if(d[s])a=a?a+" "+s:s;else if(a.length)for(var c=s.length,t=0;(t=a.indexOf(s,t))>=0;){var i=t+c;(t===0||pe.includes(a[t-1]))&&(i===a.length||pe.includes(a[i]))?a=(t===0?"":a.substring(0,t))+a.substring(i+1):t=i}}return a===""?null:a}function Fe(o,k,d,a,s,c){var t=o.__className;if(ce||t!==d||t===void 0){var i=Be(d,a,c);(!ce||i!==o.getAttribute("class"))&&(i==null?o.removeAttribute("class"):o.className=i),o.__className=d}else if(c&&s!==c)for(var _ in c){var W=!!c[_];(s==null||W!==!!s[_])&&o.classList.toggle(_,W)}return c}function Q(o){return typeof o=="number"?o:typeof o=="string"?parseInt(o,10):0}function He(o){const k=[],d=a=>{const s=a.sets||1,c=Q(a.rest);for(let t=0;t<s;t++)k.push({name:a.name,type:a.type,amount:a.type==="time"?Q(a.amount):a.amount,notes:a.notes}),c>0&&t<s-1&&k.push({name:"Rest",type:"time",amount:c,notes:`Rest after set ${t+1} of ${a.name}`})};if(o.exercises)for(const a of o.exercises)d(a);else if(o.rounds)for(let a=0;a<o.rounds.length;a++){const s=o.rounds[a],c=Q(s.rest_after_round);for(let t=0;t<s.count;t++){for(const W of s.exercises)d(W);const i=t===s.count-1,_=a===o.rounds.length-1;c>0&&(!i||!_)&&k.push({name:"Round Rest",type:"time",amount:c,notes:`Rest after round ${t+1}`})}}return k}var Me=I('<p class="svelte-1l4ap58">Loading workout...</p>'),Ye=I('<h1 class="workout-complete svelte-1l4ap58">Workout Complete! ðŸŽ‰</h1> <button class="main-control svelte-1l4ap58">Go Home</button>',1),Ze=I('<p class="svelte-1l4ap58"> </p>'),je=I('<div class="timer-display svelte-1l4ap58"> </div>'),ze=I('<div class="reps-display svelte-1l4ap58"> </div>'),Je=I('<h2 class="svelte-1l4ap58"> </h2> <h1 class="svelte-1l4ap58"> </h1> <!> <!> <button><!></button>',1),Ke=I('<div class="next-up-banner svelte-1l4ap58"><span class="svelte-1l4ap58">Next up</span> <strong class="svelte-1l4ap58"> </strong></div>'),Qe=I('<div class="container svelte-1l4ap58"><!></div> <!>',1);function ct(o,k){Ve(k,!1);const d=()=>fe(Oe,"$page",s),a=()=>fe(Ue,"$workouts",s),[s,c]=Ge(),t=S(),i=S(),_=S(),W=S();let p=S([]),b=S(0),g=S(0),O,x=S(!0),T=null,h=null;function ve(){if(!h)return;const n=h.currentTime,r=h.createGain();r.connect(h.destination),r.gain.setValueAtTime(.5,n),r.gain.exponentialRampToValueAtTime(.001,n+1);const m=h.createOscillator();m.connect(r),m.type="sawtooth",m.frequency.setValueAtTime(523.25,n),m.start(n),m.stop(n+1)}function me(){const n=e(i)?`Next up: ${e(i).name}`:"You did it!",r=new SpeechSynthesisUtterance(n);speechSynthesis.speak(r)}async function X(){if("wakeLock"in navigator)try{T=await navigator.wakeLock.request("screen"),console.log("Screen Wake Lock activated."),T.addEventListener("release",()=>{console.log("Screen Wake Lock released automatically.")})}catch(n){console.error(`Failed to activate wake lock: ${n.name}, ${n.message}`)}else console.warn("Screen Wake Lock API not supported.")}function $(){T&&(T.release(),T=null,console.log("Screen Wake Lock released manually."))}function ee(){T!==null&&document.visibilityState==="visible"&&!e(x)&&X()}Ee(()=>{const n=d().params.slug;if(!n){K("/");return}const r=decodeURIComponent(n),m=a().find(C=>C.name===r);m?(f(p,He(m)),e(p).length>0&&e(p)[0].type==="time"&&f(g,e(p)[0].amount)):K("/");try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}document.addEventListener("visibilitychange",ee),window.addEventListener("pagehide",$)});function te(){f(x,!1),X(),e(g)<=0&&e(t).type==="time"&&f(g,e(t).amount),O=setInterval(()=>{ue(g,-1),e(t).type==="time"&&e(g)===5&&me(),e(g)<=0&&(ve(),ae())},1e3)}function ae(){clearInterval(O);const n=e(b)+1;if(n<e(p).length){f(b,n);const r=e(p)[n];r.type==="time"?(f(g,r.amount),te()):(f(x,!0),f(g,0),$())}else ue(b),f(x,!0),f(g,0),$()}function de(){if(e(t)){if(e(t).type==="reps"){ae();return}if(e(x)){if(!h)try{h=new(window.AudioContext||window.webkitAudioContext)}catch{console.error("Web Audio API is not supported in this browser")}te()}else f(x,!0),clearInterval(O),$()}}Pe(()=>{clearInterval(O),$(),document.removeEventListener("visibilitychange",ee),window.removeEventListener("pagehide",$),h&&h.close()}),B(()=>(e(p),e(b)),()=>{f(t,e(p)[e(b)])}),B(()=>(e(p),e(b)),()=>{f(i,e(p)[e(b)+1])}),B(()=>(e(t),e(p)),()=>{f(_,e(t)===void 0&&e(p).length>0)}),B(()=>(e(g),e(t)),()=>{f(W,e(g)>0?e(g):e(t)?.type==="time"?e(t).amount:0)}),qe(),Ce();var ne=Qe(),F=V(ne),ge=y(F);{var he=n=>{var r=Me();v(n,r)},_e=n=>{var r=z(),m=V(r);{var C=E=>{var D=Ye(),H=R(V(D),2);le("click",H,()=>K("/")),v(E,D)},ke=E=>{var D=z(),H=V(D);{var be=M=>{var oe=Je(),Y=V(oe),xe=y(Y);w(Y);var Z=R(Y,2),Se=y(Z,!0);w(Z);var se=R(Z,2);{var Le=l=>{var u=Ze(),N=y(u,!0);w(u),G(()=>q(N,(e(t),L(()=>e(t).notes)))),v(l,u)};A(se,l=>{e(t),L(()=>e(t).notes)&&l(Le)})}var re=R(se,2);{var Ae=l=>{var u=je(),N=y(u);w(u),G(()=>q(N,`${e(W)??""}s`)),v(l,u)},Ie=l=>{var u=ze(),N=y(u);w(u),G(()=>q(N,`${e(t),L(()=>e(t).amount)??""} reps`)),v(l,u)};A(re,l=>{e(t),L(()=>e(t).type==="time")?l(Ae):l(Ie,!1)})}var U=R(re,2);let ie;var We=y(U);{var Ne=l=>{var u=J("Next");v(l,u)},Re=l=>{var u=z(),N=V(u);{var Te=P=>{var j=J("Start");v(P,j)},$e=P=>{var j=J("Pause");v(P,j)};A(N,P=>{e(x)?P(Te):P($e,!1)},!0)}v(l,u)};A(We,l=>{e(t),L(()=>e(t).type==="reps")?l(Ne):l(Re,!1)})}w(U),G(()=>{q(xe,`Step ${e(b)+1} of ${e(p),L(()=>e(p).length)??""}`),q(Se,(e(t),L(()=>e(t).name))),ie=Fe(U,1,"main-control svelte-1l4ap58",null,ie,{pause:e(t).type==="time"&&!e(x)})}),le("click",U,de),v(M,oe)};A(H,M=>{e(t)&&M(be)},!0)}v(E,D)};A(m,E=>{e(_)?E(C):E(ke,!1)},!0)}v(n,r)};A(ge,n=>{!e(t)&&!e(_)?n(he):n(_e,!1)})}w(F);var ye=R(F,2);{var we=n=>{var r=Ke(),m=R(y(r),2),C=y(m,!0);w(m),w(r),G(()=>q(C,(e(i),L(()=>e(i).name)))),v(n,r)};A(ye,n=>{e(i)&&n(we)})}v(o,ne),De(),c()}export{ct as component};

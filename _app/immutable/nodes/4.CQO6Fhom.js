import{f as R,a as w,c as ae}from"../chunks/BaYVzIlS.js";import{i as se}from"../chunks/C9QFpJqr.js";import{l as oe,c as Et,ah as re,p as le,P as ve,ai as ie,aj as ne,v as ue,B as ce,ak as fe,al as de,C as _e,z as t,y as Rt,am as nt,A as O,F as u,I as v,af as ut,D as a,u as d,J as D,an as ct,ao as C,ag as me,ac as zt}from"../chunks/DGYGATz2.js";import{e as _,s as K}from"../chunks/B5P6LH3H.js";import{i as Q}from"../chunks/ChU5yNDt.js";import{r as P,s as p,e as At,i as pe}from"../chunks/0R1yOjZG.js";import{b as M}from"../chunks/B48QFUce.js";import{s as be,a as Bt}from"../chunks/CDk6z-82.js";import{p as he}from"../chunks/BfR5zUh3.js";import{w as Nt}from"../chunks/DOHu0OQc.js";import{g as ft}from"../chunks/oDULkbCW.js";function Pt(i,$,T=!1){if(i.multiple){if($==null)return;if(!ve($))return ie();for(var S of i.options)S.selected=$.includes(x(S));return}for(S of i.options){var q=x(S);if(ne(q,$)){S.selected=!0;return}}(!T||$!==void 0)&&(i.selectedIndex=-1)}function je(i){var $=new MutationObserver(()=>{Pt(i,i.__value)});$.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ue(()=>{$.disconnect()})}function $e(i,$,T=$){var S=new WeakSet,q=!0;oe(i,"change",N=>{var e=N?"[selected]":":checked",b;if(i.multiple)b=[].map.call(i.querySelectorAll(e),x);else{var J=i.querySelector(e)??i.querySelector("option:not([disabled])");b=J&&x(J)}T(b),Et!==null&&S.add(Et)}),re(()=>{var N=$();if(i===document.activeElement){var e=le??Et;if(S.has(e))return}if(Pt(i,N,q),q&&N===void 0){var b=i.querySelector(":checked");b!==null&&(N=x(b),T(N))}i.__value=N,q=!1}),je(i)}function x(i){return"__value"in i?i.__value:i.value}var ge=R('<div class="exercise-item svelte-thejo2"><div class="move-buttons svelte-thejo2"><button class="move-button svelte-thejo2">&uarr;</button> <button class="move-button svelte-thejo2">&darr;</button></div> <div class="exercise-form svelte-thejo2"><div><label class="svelte-thejo2">Name</label> <input class="svelte-thejo2"/></div> <div><label class="svelte-thejo2">Type</label> <select class="svelte-thejo2"><option>Reps</option><option>Time</option></select></div> <div><label class="svelte-thejo2">Amount</label> <input type="text" class="svelte-thejo2"/></div> <div><label class="svelte-thejo2">Sets</label> <input type="number" min="1" class="svelte-thejo2"/></div> <div><label class="svelte-thejo2">Rest</label> <input type="text" placeholder="e.g. 45" class="svelte-thejo2"/></div> <div class="exercise-form-notes svelte-thejo2"><label class="svelte-thejo2">Notes</label> <textarea rows="2" class="svelte-thejo2"></textarea></div></div> <button class="button-delete-small svelte-thejo2" title="Delete Exercise">&times;</button></div>'),ke=R('<div class="round-card svelte-thejo2"><div class="round-header svelte-thejo2"><div class="move-buttons svelte-thejo2"><button class="move-button svelte-thejo2">&uarr;</button> <button class="move-button svelte-thejo2">&darr;</button></div> <h3 class="svelte-thejo2"> </h3> <div class="round-controls svelte-thejo2"><label class="svelte-thejo2">Count:</label> <input type="number" min="1" class="svelte-thejo2"/> <label class="svelte-thejo2">Rest After:</label> <input type="text" placeholder="e.g. 60" class="svelte-thejo2"/></div> <button class="button-delete-small svelte-thejo2" title="Delete Round">&times;</button></div> <div class="exercise-list svelte-thejo2"></div> <button class="button-add svelte-thejo2">+ Add Exercise</button></div>'),ye=R('<div class="rounds-container"></div> <button class="button-add svelte-thejo2">+ Add Round</button>',1),we=R("<span> </span>"),Se=R("<span> </span>"),Ee=R('<div class="exercise-notes svelte-thejo2"> </div>'),Re=R('<li class="svelte-thejo2"><div class="exercise-name svelte-thejo2"> </div> <div class="exercise-details svelte-thejo2"> <!> <!></div> <!></li>'),Ae=R('<p>Inline editing for this workout format is not yet available.</p> <ul class="exercise-list standalone svelte-thejo2"></ul>',1),Ne=R('<input class="workout-name-input svelte-thejo2"/> <div class="actions svelte-thejo2"><a class="button button-start svelte-thejo2">Start Workout</a> <button class="button button-delete svelte-thejo2">Delete Workout</button></div> <h2 class="svelte-thejo2">Workout Structure</h2> <!>',1),We=R("<p>Workout not found. Loading...</p>"),Ce=R('<div class="container svelte-thejo2"><!></div>');function Pe(i,$){ce($,!1);const T=()=>Bt(he,"$page",q),S=()=>Bt(Nt,"$workouts",q),[q,N]=be();let e=Rt(),b=Rt(""),J=Rt(0);function h(){if(!t(e))return;const s=JSON.parse(JSON.stringify(t(e)));if(s.rounds&&s.rounds.forEach(r=>{delete r.id,r.exercises.forEach(n=>delete n.id)}),s.rounds&&s.rounds.forEach(r=>{r.count=Number(r.count)||1,r.exercises.forEach(n=>{n.amount=Number(n.amount)||0,n.sets=Number(n.sets)||1})}),Nt.update(r=>{const n=new Map(r.map(c=>[c.name,c]));return t(b)&&t(b)!==s.name&&n.delete(t(b)),n.set(s.name,s),Array.from(n.values())}),t(b)!==t(e).name){const r=encodeURIComponent(t(e).name);history.replaceState({},"",`/workout/${r}`),O(b,t(e).name)}}function Gt(){t(e)&&(t(e).rounds||ct(e,t(e).rounds=[]),t(e).rounds.push({id:nt(J),count:1,exercises:[{}]}),O(e,t(e)),h())}function Ht(s){!t(e)||!t(e).rounds||confirm("Are you sure you want to delete this round?")&&(t(e).rounds.splice(s,1),O(e,t(e)),h())}function Kt(s){!t(e)||!t(e).rounds||(t(e).rounds[s].exercises.push({id:nt(J)}),O(e,t(e)),h())}function Qt(s,r){!t(e)||!t(e).rounds||confirm("Are you sure you want to delete this exercise?")&&(t(e).rounds[s].exercises.splice(r,1),O(e,t(e)),h())}function Vt(){t(e)&&confirm(`Are you sure you want to delete "${t(e).name}"?`)&&(Nt.update(s=>s.filter(r=>r.name!==t(b))),ft("/"))}function Wt(s,r){if(!t(e)||!t(e).rounds)return;const n=r==="up"?s-1:s+1;if(n<0||n>=t(e).rounds.length)return;const[c]=t(e).rounds.splice(s,1);t(e).rounds.splice(n,0,c),ct(e,t(e).rounds=t(e).rounds),h()}function Ct(s,r,n){if(!t(e)||!t(e).rounds)return;const c=t(e).rounds[s].exercises,W=n==="up"?r-1:r+1;if(W<0||W>=c.length)return;const[V]=c.splice(r,1);c.splice(W,0,V),ct(e,t(e).rounds[s].exercises=c),O(e,t(e)),h()}fe(()=>(T(),t(e),t(b),S(),t(J),ft),()=>{const s=T().params.slug;if(s){const r=decodeURIComponent(s);if(!t(e)||t(b)!==r){const n=S().find(c=>c.name===r);if(n){const c=JSON.parse(JSON.stringify(n));c.rounds&&c.rounds.forEach(W=>{W.id=nt(J),W.exercises.forEach(V=>{V.id=nt(J)})}),O(e,c),O(b,t(e).name)}else ft("/")}}else ft("/")}),de(),se();var dt=Ce(),Xt=u(dt);{var Yt=s=>{var r=Ne(),n=ut(r);P(n);var c=a(n,2),W=u(c),V=a(W,2);v(c);var It=a(c,4);{var xt=A=>{var X=ye(),Y=ut(X);At(Y,7,()=>(t(e),d(()=>t(e).rounds)),U=>U.id,(U,m,o)=>{var Z=ke(),l=u(Z),F=u(l),L=u(F),tt=a(L,2);v(F);var z=a(F,2),et=u(z);v(z);var G=a(z,2),at=u(G),B=a(at,2);P(B);var st=a(B,2),H=a(st,2);P(H),v(G);var mt=a(G,2);v(l);var j=a(l,2);At(j,7,()=>(t(m),d(()=>t(m).exercises)),k=>k.id,(k,y,f)=>{var pt=ge(),bt=u(pt),ht=u(bt),qt=a(ht,2);v(bt);var jt=a(bt,2),$t=u(jt),Jt=u($t),ot=a(Jt,2);P(ot),v($t);var gt=a($t,2),Ot=u(gt),I=a(Ot,2);D(()=>{t(y),C(()=>{t(o),t(f)})});var kt=u(I);kt.value=kt.__value="reps";var Dt=a(kt);Dt.value=Dt.__value="time",v(I),v(gt);var yt=a(gt,2),Mt=u(yt),rt=a(Mt,2);P(rt),v(yt);var wt=a(yt,2),Tt=u(wt),lt=a(Tt,2);P(lt),v(wt);var St=a(wt,2),Ut=u(St),vt=a(Ut,2);P(vt),v(St);var Ft=a(St,2),Lt=u(Ft),it=a(Lt,2);me(it),v(Ft),v(jt);var ee=a(jt,2);v(pt),D(()=>{ht.disabled=t(f)===0,qt.disabled=(zt(t(f)),t(m),d(()=>t(f)===t(m).exercises.length-1)),p(Jt,"for",`ex-name-${t(o)??""}-${t(f)??""}`),p(ot,"id",`ex-name-${t(o)??""}-${t(f)??""}`),p(Ot,"for",`ex-type-${t(o)??""}-${t(f)??""}`),p(I,"id",`ex-type-${t(o)??""}-${t(f)??""}`),p(Mt,"for",`ex-amount-${t(o)??""}-${t(f)??""}`),p(rt,"id",`ex-amount-${t(o)??""}-${t(f)??""}`),p(Tt,"for",`ex-sets-${t(o)??""}-${t(f)??""}`),p(lt,"id",`ex-sets-${t(o)??""}-${t(f)??""}`),p(Ut,"for",`ex-rest-${t(o)??""}-${t(f)??""}`),p(vt,"id",`ex-rest-${t(o)??""}-${t(f)??""}`),p(Lt,"for",`ex-notes-${t(o)??""}-${t(f)??""}`),p(it,"id",`ex-notes-${t(o)??""}-${t(f)??""}`)}),_("click",ht,()=>Ct(t(o),t(f),"up")),_("click",qt,()=>Ct(t(o),t(f),"down")),M(ot,()=>t(y).name,E=>(t(y).name=E,C(()=>(t(m),t(e))))),_("blur",ot,h),$e(I,()=>t(y).type,E=>(t(y).type=E,C(()=>(t(m),t(e))))),_("change",I,h),M(rt,()=>t(y).amount,E=>(t(y).amount=E,C(()=>(t(m),t(e))))),_("blur",rt,h),M(lt,()=>t(y).sets,E=>(t(y).sets=E,C(()=>(t(m),t(e))))),_("blur",lt,h),M(vt,()=>t(y).rest,E=>(t(y).rest=E,C(()=>(t(m),t(e))))),_("blur",vt,h),M(it,()=>t(y).notes,E=>(t(y).notes=E,C(()=>(t(m),t(e))))),_("blur",it,h),_("click",ee,()=>Qt(t(o),t(f))),w(k,pt)}),v(j);var g=a(j,2);v(Z),D(()=>{L.disabled=t(o)===0,tt.disabled=(zt(t(o)),t(e),d(()=>t(o)===t(e).rounds.length-1)),K(et,`Round ${t(o)+1}`),p(at,"for",`round-count-${t(o)??""}`),p(B,"id",`round-count-${t(o)??""}`),p(st,"for",`round-rest-${t(o)??""}`),p(H,"id",`round-rest-${t(o)??""}`)}),_("click",L,()=>Wt(t(o),"up")),_("click",tt,()=>Wt(t(o),"down")),M(B,()=>t(m).count,k=>(t(m).count=k,C(()=>t(e)))),_("blur",B,h),M(H,()=>t(m).rest_after_round,k=>(t(m).rest_after_round=k,C(()=>t(e)))),_("blur",H,h),_("click",mt,()=>Ht(t(o))),_("click",g,()=>Kt(t(o))),w(U,Z)}),v(Y);var _t=a(Y,2);_("click",_t,Gt),w(A,X)},te=A=>{var X=ae(),Y=ut(X);{var _t=U=>{var m=Ae(),o=a(ut(m),2);At(o,5,()=>(t(e),d(()=>t(e).exercises)),pe,(Z,l)=>{var F=Re(),L=u(F),tt=u(L,!0);v(L);var z=a(L,2),et=u(z),G=a(et);{var at=j=>{var g=we(),k=u(g);v(g),D(()=>K(k,` • ${t(l),d(()=>t(l).sets)??""} sets`)),w(j,g)};Q(G,j=>{t(l),d(()=>t(l).sets&&t(l).sets>1)&&j(at)})}var B=a(G,2);{var st=j=>{var g=Se(),k=u(g);v(g),D(()=>K(k,` • ${t(l),d(()=>t(l).rest)??""}${t(l),d(()=>typeof t(l).rest=="number"?"s":"")??""}
                  rest`)),w(j,g)};Q(B,j=>{t(l),d(()=>t(l).rest)&&j(st)})}v(z);var H=a(z,2);{var mt=j=>{var g=Ee(),k=u(g,!0);v(g),D(()=>K(k,(t(l),d(()=>t(l).notes)))),w(j,g)};Q(H,j=>{t(l),d(()=>t(l).notes)&&j(mt)})}v(F),D(()=>{K(tt,(t(l),d(()=>t(l).name))),K(et,`${t(l),d(()=>t(l).amount)??""}${t(l),d(()=>t(l).type==="reps"?" reps":typeof t(l).amount=="number"?"s":"")??""} `)}),w(Z,F)}),v(o),w(U,m)};Q(Y,U=>{t(e),d(()=>t(e).exercises)&&U(_t)},!0)}w(A,X)};Q(It,A=>{t(e),d(()=>t(e).rounds)?A(xt):A(te,!1)})}D(A=>p(W,"href",`/workout/${A??""}/run`),[()=>(t(e),d(()=>encodeURIComponent(t(e).name)))]),M(n,()=>t(e).name,A=>ct(e,t(e).name=A)),_("blur",n,h),_("click",V,Vt),w(s,r)},Zt=s=>{var r=We();w(s,r)};Q(Xt,s=>{t(e)?s(Yt):s(Zt,!1)})}v(dt),w(i,dt),_e(),N()}export{Pe as component};

import{f as S,a as g,e as A,c as aa}from"../chunks/BDuLsZKY.js";import{i as ea}from"../chunks/CU28HvW-.js";import{l as sa,c as St,an as ra,p as oa,w as la,ao as va,ap as ia,W as na,a0 as ua,a7 as pa,a8 as ca,a1 as da,e as t,x as Et,aq as st,Z as F,a2 as u,a5 as l,a9 as rt,a3 as e,u as d,a6 as O,ar as ot,as as W,am as fa,ai as Lt}from"../chunks/CEpFFJjy.js";import{s as G}from"../chunks/CoB_gn-2.js";import{i as H}from"../chunks/YPQZep5m.js";import{e as Rt,i as _a}from"../chunks/BO-cx_9R.js";import{r as Z,s as _}from"../chunks/Bi2WSQJX.js";import{b as J}from"../chunks/m47uNaFd.js";import{s as ma,a as Ft}from"../chunks/DyuGTZZS.js";import{p as ba}from"../chunks/C-5BzL7G.js";import{w as Zt}from"../chunks/CKlytb3N.js";import{g as lt}from"../chunks/D_F1M1T5.js";function jt(v,w,M=!1){if(v.multiple){if(w==null)return;if(!la(w))return va();for(var k of v.options)k.selected=w.includes(Y(k));return}for(k of v.options){var q=Y(k);if(ia(q,w)){k.selected=!0;return}}(!M||w!==void 0)&&(v.selectedIndex=-1)}function wa(v){var w=new MutationObserver(()=>{jt(v,v.__value)});w.observe(v,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),na(()=>{w.disconnect()})}function za(v,w,M=w){var k=new WeakSet,q=!0;sa(v,"change",R=>{var a=R?"[selected]":":checked",m;if(v.multiple)m=[].map.call(v.querySelectorAll(a),Y);else{var C=v.querySelector(a)??v.querySelector("option:not([disabled])");m=C&&Y(C)}M(m),St!==null&&k.add(St)}),ra(()=>{var R=w();if(v===document.activeElement){var a=oa??St;if(k.has(a))return}if(jt(v,R,q),q&&R===void 0){var m=v.querySelector(":checked");m!==null&&(R=Y(m),M(R))}v.__value=R,q=!1}),wa(v)}function Y(v){return"__value"in v?v.__value:v.value}var $a=S('<div class="exercise-item svelte-15w24zp"><div class="move-buttons svelte-15w24zp"><button class="move-button svelte-15w24zp">&uarr;</button> <button class="move-button svelte-15w24zp">&darr;</button></div> <div class="exercise-form svelte-15w24zp"><div><label class="svelte-15w24zp">Name</label> <input class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Type</label> <select class="svelte-15w24zp"><option>Reps</option><option>Time</option></select></div> <div><label class="svelte-15w24zp">Amount</label> <input type="text" class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Sets</label> <input type="number" min="1" class="svelte-15w24zp"/></div> <div><label class="svelte-15w24zp">Rest</label> <input type="text" placeholder="e.g. 45" class="svelte-15w24zp"/></div> <div class="exercise-form-notes svelte-15w24zp"><label class="svelte-15w24zp">Notes</label> <textarea rows="2" class="svelte-15w24zp"></textarea></div></div> <button class="button-delete-small svelte-15w24zp" title="Delete Exercise">&times;</button></div>'),ha=S('<div class="round-card svelte-15w24zp"><div class="round-header svelte-15w24zp"><div class="move-buttons svelte-15w24zp"><button class="move-button svelte-15w24zp">&uarr;</button> <button class="move-button svelte-15w24zp">&darr;</button></div> <h3 class="svelte-15w24zp"> </h3> <div class="round-controls svelte-15w24zp"><label class="svelte-15w24zp">Count:</label> <input type="number" min="1" class="svelte-15w24zp"/> <label class="svelte-15w24zp">Rest After:</label> <input type="text" placeholder="e.g. 60" class="svelte-15w24zp"/></div> <button class="button-delete-small svelte-15w24zp" title="Delete Round">&times;</button></div> <div class="exercise-list svelte-15w24zp"></div> <button class="button-add svelte-15w24zp">+ Add Exercise</button></div>'),ga=S('<div class="rounds-container"></div> <button class="button-add svelte-15w24zp">+ Add Round</button>',1),ka=S("<span> </span>"),ya=S("<span> </span>"),Sa=S('<div class="exercise-notes svelte-15w24zp"> </div>'),Ea=S('<li class="svelte-15w24zp"><div class="exercise-name svelte-15w24zp"> </div> <div class="exercise-details svelte-15w24zp"> <!> <!></div> <!></li>'),Ra=S('<p>Inline editing for this workout format is not yet available.</p> <ul class="exercise-list standalone svelte-15w24zp"></ul>',1),Na=S('<input class="workout-name-input svelte-15w24zp"/> <div class="actions svelte-15w24zp"><button class="button button-save svelte-15w24zp">Save</button> <a class="button button-cancel svelte-15w24zp">Cancel</a></div> <h2 class="svelte-15w24zp">Workout Structure</h2> <!>',1),Aa=S("<p>Workout not found. Loading...</p>"),Wa=S('<div class="container svelte-15w24zp"><!></div>');function Ba(v,w){ua(w,!1);const M=()=>Ft(ba,"$page",q),k=()=>Ft(Zt,"$workouts",q),[q,R]=ma();let a=Et(),m=Et(""),C=Et(0);function Bt(){if(!t(a))return;const s=JSON.parse(JSON.stringify(t(a)));s.rounds&&s.rounds.forEach(i=>{delete i.id,i.exercises.forEach(n=>delete n.id)}),s.rounds&&s.rounds.forEach(i=>{i.count=Number(i.count)||1,i.exercises.forEach(n=>{n.amount=Number(n.amount)||0,n.sets=Number(n.sets)||1})}),Zt.update(i=>{const n=new Map(i.map(p=>[p.name,p]));return t(m)&&t(m)!==s.name&&n.delete(t(m)),n.set(s.name,s),Array.from(n.values())}),lt(`/workout/${encodeURIComponent(s.name)}`)}function Gt(){t(a)&&(t(a).rounds||ot(a,t(a).rounds=[]),t(a).rounds.push({id:st(C),count:1,exercises:[{}]}),F(a,t(a)))}function Ht(s){!t(a)||!t(a).rounds||confirm("Are you sure you want to delete this round?")&&(t(a).rounds.splice(s,1),F(a,t(a)))}function Kt(s){!t(a)||!t(a).rounds||(t(a).rounds[s].exercises.push({id:st(C)}),F(a,t(a)))}function Pt(s,i){!t(a)||!t(a).rounds||confirm("Are you sure you want to delete this exercise?")&&(t(a).rounds[s].exercises.splice(i,1),F(a,t(a)))}function Nt(s,i){if(!t(a)||!t(a).rounds)return;const n=i==="up"?s-1:s+1;if(n<0||n>=t(a).rounds.length)return;const[p]=t(a).rounds.splice(s,1);t(a).rounds.splice(n,0,p),ot(a,t(a).rounds=t(a).rounds)}function At(s,i,n){if(!t(a)||!t(a).rounds)return;const p=t(a).rounds[s].exercises,N=n==="up"?i-1:i+1;if(N<0||N>=p.length)return;const[K]=p.splice(i,1);p.splice(N,0,K),ot(a,t(a).rounds[s].exercises=p),F(a,t(a))}pa(()=>(M(),t(a),t(m),k(),t(C),lt),()=>{const s=M().params.slug;if(s){const i=decodeURIComponent(s);if(!t(a)||t(m)!==i){const n=k().find(p=>p.name===i);if(n){const p=JSON.parse(JSON.stringify(n));p.rounds&&p.rounds.forEach(N=>{N.id=st(C),N.exercises.forEach(K=>{K.id=st(C)})}),F(a,p),F(m,t(a).name)}else lt("/")}}else lt("/")}),ca(),ea();var vt=Wa(),Qt=u(vt);{var Vt=s=>{var i=Na(),n=rt(i);Z(n);var p=e(n,2),N=u(p),K=e(N,2);l(p);var Yt=e(p,4);{var It=E=>{var P=ga(),Q=rt(P);Rt(Q,7,()=>(t(a),d(()=>t(a).rounds)),T=>T.id,(T,f,r)=>{var V=ha(),o=u(V),U=u(o),D=u(U),I=e(D,2);l(U);var L=e(U,2),x=u(L);l(L);var j=e(L,2),tt=u(j),B=e(tt,2);Z(B);var at=e(B,2),X=e(at,2);Z(X),l(j);var nt=e(j,2);l(o);var b=e(o,2);Rt(b,7,()=>(t(f),d(()=>t(f).exercises)),$=>$.id,($,h,c)=>{var ut=$a(),pt=u(ut),ct=u(pt),Wt=e(ct,2);l(pt);var dt=e(pt,2),ft=u(dt),qt=u(ft),_t=e(qt,2);Z(_t),l(ft);var mt=e(ft,2),Ct=u(mt),et=e(Ct,2);O(()=>{t(h),W(()=>{t(r),t(c)})});var bt=u(et);bt.value=bt.__value="reps";var Ot=e(bt);Ot.value=Ot.__value="time",l(et),l(mt);var wt=e(mt,2),Jt=u(wt),zt=e(Jt,2);Z(zt),l(wt);var $t=e(wt,2),Mt=u($t),ht=e(Mt,2);Z(ht),l($t);var gt=e($t,2),Tt=u(gt),kt=e(Tt,2);Z(kt),l(gt);var Ut=e(gt,2),Dt=u(Ut),yt=e(Dt,2);fa(yt),l(Ut),l(dt);var ta=e(dt,2);l(ut),O(()=>{ct.disabled=t(c)===0,Wt.disabled=(Lt(t(c)),t(f),d(()=>t(c)===t(f).exercises.length-1)),_(qt,"for",`ex-name-${t(r)??""}-${t(c)??""}`),_(_t,"id",`ex-name-${t(r)??""}-${t(c)??""}`),_(Ct,"for",`ex-type-${t(r)??""}-${t(c)??""}`),_(et,"id",`ex-type-${t(r)??""}-${t(c)??""}`),_(Jt,"for",`ex-amount-${t(r)??""}-${t(c)??""}`),_(zt,"id",`ex-amount-${t(r)??""}-${t(c)??""}`),_(Mt,"for",`ex-sets-${t(r)??""}-${t(c)??""}`),_(ht,"id",`ex-sets-${t(r)??""}-${t(c)??""}`),_(Tt,"for",`ex-rest-${t(r)??""}-${t(c)??""}`),_(kt,"id",`ex-rest-${t(r)??""}-${t(c)??""}`),_(Dt,"for",`ex-notes-${t(r)??""}-${t(c)??""}`),_(yt,"id",`ex-notes-${t(r)??""}-${t(c)??""}`)}),A("click",ct,()=>At(t(r),t(c),"up")),A("click",Wt,()=>At(t(r),t(c),"down")),J(_t,()=>t(h).name,y=>(t(h).name=y,W(()=>(t(f),t(a))))),za(et,()=>t(h).type,y=>(t(h).type=y,W(()=>(t(f),t(a))))),J(zt,()=>t(h).amount,y=>(t(h).amount=y,W(()=>(t(f),t(a))))),J(ht,()=>t(h).sets,y=>(t(h).sets=y,W(()=>(t(f),t(a))))),J(kt,()=>t(h).rest,y=>(t(h).rest=y,W(()=>(t(f),t(a))))),J(yt,()=>t(h).notes,y=>(t(h).notes=y,W(()=>(t(f),t(a))))),A("click",ta,()=>Pt(t(r),t(c))),g($,ut)}),l(b);var z=e(b,2);l(V),O(()=>{D.disabled=t(r)===0,I.disabled=(Lt(t(r)),t(a),d(()=>t(r)===t(a).rounds.length-1)),G(x,`Round ${t(r)+1}`),_(tt,"for",`round-count-${t(r)??""}`),_(B,"id",`round-count-${t(r)??""}`),_(at,"for",`round-rest-${t(r)??""}`),_(X,"id",`round-rest-${t(r)??""}`)}),A("click",D,()=>Nt(t(r),"up")),A("click",I,()=>Nt(t(r),"down")),J(B,()=>t(f).count,$=>(t(f).count=$,W(()=>t(a)))),J(X,()=>t(f).rest_after_round,$=>(t(f).rest_after_round=$,W(()=>t(a)))),A("click",nt,()=>Ht(t(r))),A("click",z,()=>Kt(t(r))),g(T,V)}),l(Q);var it=e(Q,2);A("click",it,Gt),g(E,P)},xt=E=>{var P=aa(),Q=rt(P);{var it=T=>{var f=Ra(),r=e(rt(f),2);Rt(r,5,()=>(t(a),d(()=>t(a).exercises)),_a,(V,o)=>{var U=Ea(),D=u(U),I=u(D,!0);l(D);var L=e(D,2),x=u(L),j=e(x);{var tt=b=>{var z=ka(),$=u(z);l(z),O(()=>G($,` • ${t(o),d(()=>t(o).sets)??""} sets`)),g(b,z)};H(j,b=>{t(o),d(()=>t(o).sets&&t(o).sets>1)&&b(tt)})}var B=e(j,2);{var at=b=>{var z=ya(),$=u(z);l(z),O(()=>G($,` • ${t(o),d(()=>t(o).rest)??""}${t(o),d(()=>typeof t(o).rest=="number"?"s":"")??""}
                  rest`)),g(b,z)};H(B,b=>{t(o),d(()=>t(o).rest)&&b(at)})}l(L);var X=e(L,2);{var nt=b=>{var z=Sa(),$=u(z,!0);l(z),O(()=>G($,(t(o),d(()=>t(o).notes)))),g(b,z)};H(X,b=>{t(o),d(()=>t(o).notes)&&b(nt)})}l(U),O(()=>{G(I,(t(o),d(()=>t(o).name))),G(x,`${t(o),d(()=>t(o).amount)??""}${t(o),d(()=>t(o).type==="reps"?" reps":typeof t(o).amount=="number"?"s":"")??""} `)}),g(V,U)}),l(r),g(T,f)};H(Q,T=>{t(a),d(()=>t(a).exercises)&&T(it)},!0)}g(E,P)};H(Yt,E=>{t(a),d(()=>t(a).rounds)?E(It):E(xt,!1)})}O(E=>_(K,"href",`/workout/${E??""}`),[()=>(t(m),d(()=>encodeURIComponent(t(m))))]),J(n,()=>t(a).name,E=>ot(a,t(a).name=E)),A("click",N,Bt),g(s,i)},Xt=s=>{var i=Aa();g(s,i)};H(Qt,s=>{t(a)?s(Vt):s(Xt,!1)})}l(vt),g(v,vt),da(),R()}export{Ba as component};
